<html>

<head>
  <meta charset="utf-8">
  <title>Firefox: The Puppet Show</title>

  <meta name="description" content="Automating Firefox with WebDriver using Selenium and GeckoDriver">
    <meta name="author" content="Dave Hunt, Henrik Skupin">

  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <link rel="stylesheet" href="reveal.js/css/theme/league.css">
  <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

  <style type="text/css">
    pre {
      width: 100%;
    }
    code {
      padding: 1em !important;
      font-size: 75% !important;
    }
  </style>
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section>
        <h1>Firefox: The Puppet Show</h1>
        <h3>Automating Firefox with WebDriver using Selenium and GeckoDriver</h3>
      </section>

      <section>
        <h2>Topics</h2>
        <p class="fragment fade-right">Browser Automation with Selenium</p>
        <p class="fragment fade-right">What is Firefox Driver?</p>
        <p class="fragment fade-right">Marionette &amp; GeckoDriver</p>
        <p class="fragment fade-right">Page Objects with FoxPuppet</p>
      </section>

      <section>
        <section>
          <h2>Browser Automation with Selenium</h2>
        </section>
        <section>
          <ul>
            <li>Suite of tools across platforms</li>
            <li>Different bindings like Python, Java, Ruby, Javascript</li>
            <li>Support for every major browser</li>
            <li>Controls browsers via driver through WebDriver API</li>
          </ul>
        </section>
        <section>
          <object data="images/selenium-overview-legacy.svg" type="image/svg+xml">
          </object>
        </section>
      </section>

      <section>
        <section>
          <h2>What is Firefox Driver?</h2>
        </section>
        <section>
          <ul>
            <li>Specific driver to control Firefox</li>
            <li>Works through an Firefox Add-on</li>
            <li>Maintained by the Selenium community</li>
          </ul>
        </section>
        <section data-background="images/amo.jpg">
          <h3>Example</h3>
          <pre><code class="hljs">
from selenium.webdriver import Firefox

def test_search():
    selenium = Firefox()
    selenium.get('https://addons.mozilla.org')

    textbox = selenium.find_element_by_id('search-q')
    textbox.send_keys('NoScript')
    submit = selenium.find_element_by_class_name('search-button')
    submit.click()

    selenium.quit()
          </code></pre>
        </section>
        <section>
          <h3 style="color: #f00;">
            Deprecated due to add-on signing in Firefox 48
          </h3>
          <p class="fragment fade-right">
            How to solve this problem?
          </p>
        </section>
      </section>

      <section>
        <section>
          <h2>Marionette &amp; GeckoDriver</h2>
        </section>
        <section>
          <h3>Marionette</h3>
          <ul>
            <li>When first introduced? Firefox OS</li>
            <li>Automation driver for Gecko</li>
            <li>Directly build into Firefox and Fennec</li>
            <li>Can control both chrome and content</li>
            <li>Communicates via TCP sockets</li>
          </ul>
        </section>
        <section>
          <h3>GeckoDriver</h3>
          <ul>
            <li>Proxy for W3C WebDriver-compatible clients and Gecko-based browsers</li>
            <li>Provides the HTTP API as described by the WebDriver protocol</li>
            <li>Translates calls into the Marionette automation protocol</li>
            <li>Not feature complete yet</li>
          </ul>
        </section>
        <section>
          <p>Diagram</p>
          <object data="images/selenium-overview.svg" type="image/svg+xml">
          </object>
          <p>no test changes are necessary</p>
        </section>
      </section>

      <section>
        <section>
          <h2>Page Objects with FoxPuppet</h2>
        </section>
        <section>
          <p>what id does</p>
        </section>
        <section>
          <h3>Without FoxPuppet</h3>
          <pre><code>
from selenium.webdriver import Firefox

def test_install():
    selenium = Firefox()
    selenium.get('https://addons.mozilla.org/addon/adblock-plus/')
    selenium.find_element_by_css_selector('#addon .installer.button').click()
    with selenium.context(selenium.CONTEXT_CHROME):
       # TODO
    selenium.quit()
          </code></pre>
        </section>
        <section>
          <h3>With FoxPuppet</h3>
          <pre><code>
from foxpuppet import FoxPuppet
from foxpuppet.browser.notifications import (
    AddOnInstallComplete,
    AddOnInstallConfirmation)
from selenium.webdriver import Firefox

def test_install():
    selenium = Firefox()
    foxpuppet = FoxPuppet(selenium)
    selenium.get('https://addons.mozilla.org/addon/adblock-plus/')
    selenium.find_element_by_css_selector('#addon .installer.button').click()
    foxpuppet.wait_for_notification(AddOnInstallConfirmation).install()
    foxpuppet.wait_for_notification(AddOnInstallComplete).close()
    selenium.quit()
          </code></pre>
        </section>
        <section>
          <p>video</p>
        </section>
      </section>

      <section>
        <h2>Q&amp;A</h2>
      </section>

      <section>
        <h2>Thanks</h2>
        <p>Slides: <a href="https://whimboo.github.io/slides/170204_fosdem/">https://bit.ly/17-puppetshow</a></p>
        <hr/>
        <p>
          Dave Hunt &lt;<a href="mailto:dhunt@mozilla.com">dhunt@mozilla.com</a>&gt;<br/>
          <a href="http://davehunt.co.uk/">http://davehunt.co.uk/</a>
        </p>
        <p>
          Henrik Skupin &lt;<a href="mailto:hskupin@mozilla.com">hskupin@mozilla.com</a>&gt;<br/>
          <a href="https://hskupin.info/">https://hskupin.info/</a>
        </p>
      </section>

    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>
    Reveal.initialize({
      width: 800,
      height: 600,
      history: true,
      slideNumber: true,
      dependencies: [
        { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
      ]
    });
  </script>
</body>

</html>
