<html>
<head>
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <link rel="stylesheet" href="reveal.js/css/theme/league.css">
  <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

  <meta charset="utf-8">
  <title>Firefox: The Puppet Show</title>
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section>
        <h1>Firefox: The Puppet Show</h1>
        <h3>Automating Firefox with WebDriver using Selenium and GeckoDriver</h3>
      </section>

      <section>
        <h3>Presenters</h3>
        <table>
          <tbody>
            <tr>
              <td rowspan="2">Dave Hunt</td>
              <td><a href="mailto:dhunt@mozilla.com">dhunt@mozilla.com</a></td>
            </tr>
            <tr>
              <td><a href="http://davehunt.co.uk/">http://davehunt.co.uk/</a></td>
            </tr>
            <tr>
              <td rowspan="2">Henrik Skupin</td>
              <td><a href="mailto:hskupin@mozilla.com">hskupin@mozilla.com</a></td>
            </tr>
            <tr>
              <td><a href="https://hskupin.info/">https://hskupin.info/</a></td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h2>Overview</h2>
        <p class="fragment fade-right">Browser Automation with Selenium</p>
        <p class="fragment fade-right">What is Firefox Driver?</p>
        <p class="fragment fade-right">Marionette &amp; GeckoDriver</p>
        <p class="fragment fade-right">Page Objects with FoxPuppet</p>
      </section>

      <section>
        <section>
          <h2>Browser Automation with Selenium</h2>
        </section>
        <section>
          <ul>
            <li>Suite of tools across platforms</li>
            <li>Different bindings like Python, Java, Ruby, Javascript</li>
            <li>Support for every major browser</li>
            <li>Controls browsers via driver through Webdriver API</li>
          </ul>
        </section>
        <section>
          <object data="images/selenium-overview-legacy.svg" type="image/svg+xml">
          </object>
        </section>
      </section>

      <section>
        <section>
          <h2>What is Firefox Driver?</h2>
        </section>
        <section>
          <ul>
            <li>Specific driver to control Firefox</li>
            <li>Works through an Firefox Add-on</li>
            <li>Maintained by the Selenium community</li>
          </ul>
        </section>
        <section>
          <pre><code class="hljs">
from selenium.webdriver import Firefox
from selenium.webdriver.common.by import By

def test_submit():
    driver = Firefox()
    driver.get('https://addons.mozilla.org')

    input = driver.find_element(By.ID, 'search-q')
    input.send_keys('NoScript')
    submit = driver.find_element(By.CLASS, 'search-button')
    submit.click()

    driver.quit()
          </code></pre>
        </section>
        <section>
          <h3 style="color: #f00;">
            Deprecated due to add-on signing in Firefox 48
          </h3>
          <p class="fragment fade-right">
            How to solve this problem?
          </p>
        </section>
      </section>

      <section>
        <section>
          <h2>Marionette &amp; GeckoDriver</h2>
        </section>
        <section>
          <h3>Marionette</h3>
          <ul>
            <li>When first introduced? Firefox OS</li>
            <li>Automation driver for Gecko</li>
            <li>Directly build into Firefox and Fennec</li>
            <li>Can control both chrome and content</li>
            <li>Communicates via TCP sockets</li>
          </ul>
        </section>
        <section>
          <h3>GeckoDriver</h3>
          <ul>
            <li>Proxy for W3C WebDriver-compatible clients and Gecko-based browsers</li>
            <li>Provides the HTTP API as described by the WebDriver protocol</li>
            <li>Translates calls into the Marionette automation protocol</li>
            <li>Not feature complete yet</li>
          </ul>
        </section>
        <section>
          <p>Diagram</p>
          <object data="images/selenium-overview.svg" type="image/svg+xml">
          </object>
          <p>no test changes are necessary</p>
        </section>
      </section>

      <section>
        <section>
          <h2>Page Objects with FoxPuppet</h2>
        </section>
        <section>
          <p>what id does</p>
        </section>
        <section>
          <h3>Without FoxPuppet</h3>
          <pre><code>
from selenium.webdriver import Firefox

def test_install():
    selenium = Firefox()
    selenium.get('https://addons.mozilla.org/firefox/addon/adblock-plus/')
    selenium.find_element_by_css_selector('#addon .installer.button').click()
    with selenium.context(selenium.CONTEXT_CHROME):
       # TODO
    selenium.quit()
          </code></pre>
        </section>
        <section>
          <h3>With FoxPuppet</h3>
          <pre><code>
from foxpuppet import FoxPuppet
from foxpuppet.browser.notifications import (
    AddOnInstallComplete,
    AddOnInstallConfirmation)
from selenium.webdriver import Firefox

def test_install():
    selenium = Firefox()
    foxpuppet = FoxPuppet(selenium)
    selenium.get('https://addons.mozilla.org/firefox/addon/adblock-plus/')
    selenium.find_element_by_css_selector('#addon .installer.button').click()
    foxpuppet.wait_for_notification(AddOnInstallConfirmation).install()
    foxpuppet.wait_for_notification(AddOnInstallComplete).close()
    selenium.quit()
          </code></pre>
        </section>
        <section>
          <p>video</p>
        </section>
      </section>

      <section>
        <h2>Q&amp;A</h2>
      </section>

      <section>
        <h2>Thanks</h2>
        <ul>
          <li>Slides: <a href="https://">https://TODO</a></li>
          <li>Contact: </li>
        </ul>
      </section>
    </div>
  </div>
  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>
  <script>
    Reveal.initialize({
      width: 720,
      height: 576,
      history: true,
      slideNumber: true,
      dependencies: [
        // Syntax highlight for <code> elements
        { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
      ]
    });
  </script>
</body>

</html>
